log tmp.log

variable r uloop 3000
variable rs equal (40000+${r})

variable temp equal (0.8)

variable vrand equal (1552462+round(82.2*${rs}))

shell cd run


units lj                  # Use reduced LJ style units
atom_style atomic         # Uncharged point particles
atom_modify map hash      # Needed for indexing of clusters etc 
                          # Used to be able to find where atoms are in relation to each other.

# Define a lattice with which to populate the simulation cell. With units
# set to 'lj' the second argument to the lattice command is the reduced
# density rho* and the spacings are multiples of that required to acheive
# that density. Also define a simulation cell called 'box' in lattice units
# and fill it with atoms. Here we're creating a box which is ten lattice
# constants in each direction.
lattice fcc 1.0 spacing 1 1 1                  # All equal sizes - gives the right reduced density.
region box block -6 6 -6 6 -6 6 units lattice # Defines a region, "box", in lattice units
create_box 1 box                              # Creates a simulation box as specified above,
                                              # with one type of atom
create_atoms 1 box                            # Creates particles on lattice points

# Set the mass of the first (and only) atom type.
mass 1 1.0

pair_style lj/cut  3.5      
pair_modify shift yes
pair_coeff 1  1  1.0  1.0   # Intearaction between 1 and 1 set with epsilon = 1 and sigma = 1

#############################
#   M E L T   S Y S T E M   #
#############################

variable rtemp equal (47345+4*${rs})

velocity all create 2.4 ${vrand} mom yes dist gaussian # Assign velocities
                                                     # Temperature 2.4, random number seed, zero linear momentum
                                                     # Gaussian distribution

timestep 0.002   # simulation timestep
thermo 100       # output thermodynamic data every 100 steps

# Define a fix  in this case with index 1 applied to all
# particles in the simulation. This fix is for simulations
# in the anisotropic NPT ensemble. Note that we use the MTK
# correction.
fix 1 all nph iso 5.68 5.68 0.05 mtk yes pchain 5
fix 2 all temp/csvr 2.4 2.4 0.05 ${rtemp}

run 10000         # run for 10000 steps

unfix 2

fix 2 all temp/csvr 1.2 1.2 0.05 ${rtemp}

run 1000

unfix 2

variable rtemp equal (244561+9*${rs})

fix 2 all temp/csvr 1.2 ${temp} 0.05 ${rtemp}
run 2000



compute q6 all orientorder/atom degrees 1 6 components 6 nnn NULL cutoff 1.432
compute coord_number all coord/atom orientorder q6 0.5
variable is_solid atom 'c_coord_number >= 8'
group solid dynamic all var is_solid every 100    # Must be dynamic to update
compute cluster solid cluster/atom 1.432
compute clus_chunks solid chunk/atom c_cluster compress yes
compute size_chunks solid property/chunk clus_chunks count
variable max_n equal max(c_size_chunks)


# define atoms in regions
thermo_style custom step temp press vol density ke v_max_n

thermo 100

unfix 1
unfix 2

fix t1 all nph iso 5.68 5.68 0.05 mtk yes pchain 5 
fix t2 all temp/csvr ${temp} ${temp} 0.05 ${rtemp}

run 5000000 every 5000 "if '((${max_n} > 324) && (${max_n} < 526))' then 'write_data ${rs}_${max_n}_seed.data' 'jump SELF EXT' " 
   

label EXT
clear 
shell cd ../
next r
jump SELF
